<!-- hht/renderer/form.html -->
<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Add/Edit Plot</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="loading-overlay hidden" id="loadingOverlay">
        <div class="spinner"></div>
    </div>

    <div class="form-container">
        <h1 id="formTitle">Add Plot</h1>
        <form id="plotForm">
            <label for="plot_number">Plot Number:</label>
            <input type="text" id="plot_number" required>

            <label for="entrance_facing">Entrance Facing:</label>
            <select id="entrance_facing" required>
                <option value="">Select Direction</option>
                <option value="North">North</option>
                <option value="South">South</option>
                <option value="East">East</option>
                <option value="West">West</option>
                <option value="North East">North East</option>
                <option value="North West">North West</option>
                <option value="South East">South East</option>
                <option value="South West">South West</option>
            </select>

            <label>Cost Known:</label>
            <div class="radio-group">
                <label>
                    <input type="radio" name="cost_known" id="cost_known_yes" value="yes" checked> Yes
                </label>
                <label>
                    <input type="radio" name="cost_known" id="cost_known_no" value="no"> No (Range)
                </label>
            </div>

            <div id="costValueField">
                <label for="cost_value">Known Cost:</label>
                <input type="number" id="cost_value" placeholder="e.g., 350000">
            </div>

            <div id="costRangeField" class="hidden">
                <label for="min_cost">Min Cost:</label>
                <input type="number" id="min_cost" placeholder="e.g., 300000">
                <label for="max_cost">Max Cost:</label>
                <input type="number" id="max_cost" placeholder="e.g., 400000">
            </div>

            <label for="stamp_duty">Stamp Duty:</label>
            <!--<input type="text" id="stamp_duty" placeholder="e.g., £7,500.00 or £5,000.00 - £7,500.00">-->
            <input type="text" name="stamp_duty" id="stamp_duty" readonly style="background-color: #eee; cursor: not-allowed;"><br/>

            <h2 class="section-title">Location & Development</h2>
            <label for="location_select">Location:</label>
            <div class="field-with-add-button">
                <select id="location_select" required></select>
                <button type="button" id="addNewLocationBtn" class="add-new-btn">Add New</button>
            </div>
            <div id="newLocationInputContainer" class="new-item-input-container hidden">
                <input type="text" id="newLocationName" class="new-item-input" placeholder="New Location Name">
                <button type="button" id="saveNewLocationBtn" class="new-item-save-btn">Save</button>
                <button type="button" id="cancelNewLocationBtn" class="new-item-cancel-btn">X</button>
            </div>
            <div id="editLocationInputContainer" class="edit-item-input-container hidden">
                <input type="text" id="editLocationName" class="edit-item-input" placeholder="Edit Location Name">
                <button type="button" id="saveLocationBtn" class="edit-item-save-btn">Save</button>
                <button type="button" id="cancelLocationBtn" class="edit-item-cancel-btn">X</button>
            </div>
            
            <label for="development_select">Development:</label>
            <div class="field-with-add-button">
                <select id="development_select" required></select>
                <button type="button" id="addNewDevelopmentBtn" class="add-new-btn">Add New</button>
            </div>
            <div id="newDevelopmentInputContainer" class="new-item-input-container hidden">
                <input type="text" id="newDevelopmentName" class="new-item-input" placeholder="New Development Name">
                <button type="button" id="saveNewDevelopmentBtn" class="new-item-save-btn">Save</button>
                <button type="button" id="cancelNewDevelopmentBtn" class="new-item-cancel-btn">X</button>
            </div>
            <div id="editDevelopmentInputContainer" class="edit-item-input-container hidden">
                <input type="text" id="editDevelopmentName" class="edit-item-input" placeholder="Edit Development Name">
                <button type="button" id="saveDevelopmentBtn" class="edit-item-save-btn">Save</button>
                <button type="button" id="cancelDevelopmentBtn" class="edit-item-cancel-btn">X</button>
            </div>


            <h2 class="section-title">Builder & House Model</h2>
            <label for="builder_select">Builder:</label>
            <div class="field-with-add-button">
                <select id="builder_select" required></select>
                <button type="button" id="addNewBuilderBtn" class="add-new-btn">Add New</button>
            </div>
            <div id="newBuilderInputContainer" class="new-item-input-container hidden">
                <input type="text" id="newBuilderName" class="new-item-input" placeholder="New Builder Name">
                <button type="button" id="saveNewBuilderBtn" class="new-item-save-btn">Save</button>
                <button type="button" id="cancelNewBuilderBtn" class="new-item-cancel-btn">X</button>
            </div>
            <div id="editBuilderInputContainer" class="edit-item-input-container hidden">
                <input type="text" id="editBuilderName" class="edit-item-input" placeholder="Edit Builder Name">
                <button type="button" id="saveBuilderBtn" class="edit-item-save-btn">Save</button>
                <button type="button" id="cancelBuilderBtn" class="edit-item-cancel-btn">X</button>
            </div>
            <div id="linkBuilderToDevelopmentContainer" class="new-item-input-container hidden">
                <label for="existingBuilderSelect" style="margin-top: 0;">Link Existing Builder:</label>
                <select id="existingBuilderSelect" class="new-item-input" style="width: auto; flex-grow: 1;"></select>
                <button type="button" id="saveLinkBuilderBtn" class="new-item-save-btn">Link</button>
                <button type="button" id="cancelLinkBuilderBtn" class="new-item-cancel-btn">X</button>
            </div>

            <label for="house_model_select">House Model:</label>
            <div class="field-with-add-button">
                <select id="house_model_select" required></select>
                <button type="button" id="addNewHouseModelBtn" class="add-new-btn">Add New</button>
            </div>
            <div id="newHouseModelInputContainer" class="new-item-input-container hidden">
                <input type="text" id="newHouseModelName" class="new-item-input" placeholder="New House Model Name">
                <button type="button" id="saveNewHouseModelBtn" class="new-item-save-btn">Save</button>
                <button type="button" id="cancelNewHouseModelBtn" class="new-item-cancel-btn">X</button>
            </div>
            <div id="editHouseModelInputContainer" class="edit-item-input-container hidden">
                <input type="text" id="editHouseModelName" class="edit-item-input" placeholder="Edit House Model Name">
                <button type="button" id="saveHouseModelBtn" class="edit-item-save-btn">Save</button>
                <button type="button" id="cancelHouseModelBtn" class="edit-item-cancel-btn">X</button>
            </div>

            <!-- ********** NEW: Container for House Model Read-Only Details ********** -->
            <div id="houseModelSummaryDisplay" class="house-model-summary-display hidden">
                <h3 class="summary-title">House Model Details:</h3>
                <div id="summaryRooms" class="summary-section"></div>
                <div id="summaryFeatures" class="summary-section"></div>
            </div>
            <!-- ************************************************************************ -->

            <div id="houseModelDetailsSectionButtons" class="house-model-details-section-buttons hidden">
                <label>House Model Rooms & Features:</label>
                <button type="button" id="editModelDetailsBtn" class="action-button-primary">Edit Details</button>
            </div>

            <div class="form-actions">
                <button type="submit" id="submitButton" class="action-button-primary">Save</button>
                <button type="button" id="cancelButton" class="action-button-secondary" onclick="window.location.href='index.html'">Cancel</button>
            </div>
        </form>
    </div>

    <!-- House Model Details Modal (Already exists) -->
    <div id="houseModelDetailsModal" class="modal-overlay hidden">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">Edit House Model Details</h2>
                <button type="button" class="modal-close-button" id="closeModelDetailsModalBtn">&times;</button>
            </div>
            <div class="modal-body">
                <div class="field-group">
                    <label>Rooms:</label>
                    <div id="roomsContainer" class="grid-container">
                        <!-- Room inputs will be dynamically added here -->
                    </div>
                    <button type="button" id="addRoomBtn" class="add-new-btn">Add Room</button>
                </div>
                <div class="field-group">
                    <label>Features:</label>
                    <div id="featuresContainer" class="grid-container">
                        <!-- Feature inputs will be dynamically added here -->
                    </div>
                    <button type="button" id="addFeatureBtn" class="add-new-btn">Add Feature</button>
                </div>
            </div>
            <div class="house-model-details-actions">
                <button type="button" id="saveModelDetailsBtn" class="action-button-primary">Save Details</button>
                <button type="button" id="cancelModelDetailsBtn" class="action-button-secondary">Cancel</button>
            </div>
        </div>
    </div>
    
    <script type="module" src="./js/form-main.js"></script>
</body>
</html>
